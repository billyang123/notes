define("selectize/index",["selectize/Sifter","selectize/MicroPlugin"],function(a,b){var c=a("selectize/Sifter"),d=a("selectize/MicroPlugin"),e=function(a,b){if("string"!=typeof b||b.length){var c="string"==typeof b?new RegExp(b,"i"):b,d=function(a){var b=0;if(3===a.nodeType){var e=a.data.search(c);if(e>=0&&a.data.length>0){var f=a.data.match(c),g=document.createElement("span");g.className="highlight";var h=a.splitText(e),i=(h.splitText(f[0].length),h.cloneNode(!0));g.appendChild(i),h.parentNode.replaceChild(g,h),b=1}}else if(1===a.nodeType&&a.childNodes&&!/(script|style)/i.test(a.tagName))for(var j=0;j<a.childNodes.length;++j)j+=d(a.childNodes[j]);return b};return a.each(function(){d(this)})}},f=function(){};f.prototype={on:function(a,b){this._events=this._events||{},this._events[a]=this._events[a]||[],this._events[a].push(b)},off:function(a,b){var c=arguments.length;return 0===c?delete this._events:1===c?delete this._events[a]:(this._events=this._events||{},void(a in this._events!=!1&&this._events[a].splice(this._events[a].indexOf(b),1)))},trigger:function(a){if(this._events=this._events||{},a in this._events!=!1)for(var b=0;b<this._events[a].length;b++)this._events[a][b].apply(this,Array.prototype.slice.call(arguments,1))}},f.mixin=function(a){for(var b=["on","off","trigger"],c=0;c<b.length;c++)a.prototype[b[c]]=f.prototype[b[c]]};var g=/Mac/.test(navigator.userAgent),h=65,i=13,j=27,k=37,l=38,m=80,n=39,o=40,p=78,q=8,r=46,s=16,t=g?91:17,u=g?18:17,v=9,w=1,x=2,y=!/android/i.test(window.navigator.userAgent)&&!!document.createElement("form").validity,z=function(a){return"undefined"!=typeof a},A=function(a){return"undefined"==typeof a||null===a?null:"boolean"==typeof a?a?"1":"0":a+""},B=function(a){return(a+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},C=function(a){return(a+"").replace(/\$/g,"$$$$")},D={};D.before=function(a,b,c){var d=a[b];a[b]=function(){return c.apply(a,arguments),d.apply(a,arguments)}},D.after=function(a,b,c){var d=a[b];a[b]=function(){var b=d.apply(a,arguments);return c.apply(a,arguments),b}};var E=function(a){var b=!1;return function(){b||(b=!0,a.apply(this,arguments))}},F=function(a,b){var c;return function(){var d=this,e=arguments;window.clearTimeout(c),c=window.setTimeout(function(){a.apply(d,e)},b)}},G=function(a,b,c){var d,e=a.trigger,f={};a.trigger=function(){var c=arguments[0];return-1===b.indexOf(c)?e.apply(a,arguments):void(f[c]=arguments)},c.apply(a,[]),a.trigger=e;for(d in f)f.hasOwnProperty(d)&&e.apply(a,f[d])},H=function(a,b,c,d){a.on(b,c,function(b){for(var c=b.target;c&&c.parentNode!==a[0];)c=c.parentNode;return b.currentTarget=c,d.apply(this,[b])})},I=function(a){var b={};if("selectionStart"in a)b.start=a.selectionStart,b.length=a.selectionEnd-b.start;else if(document.selection){a.focus();var c=document.selection.createRange(),d=document.selection.createRange().text.length;c.moveStart("character",-a.value.length),b.start=c.text.length-d,b.length=d}return b},J=function(a,b,c){var d,e,f={};if(c)for(d=0,e=c.length;e>d;d++)f[c[d]]=a.css(c[d]);else f=a.css();b.css(f)},K=function(a,b){if(!a)return 0;var c=$("<test>").css({position:"absolute",top:-99999,left:-99999,width:"auto",padding:0,whiteSpace:"pre"}).text(a).appendTo("body");J(b,c,["letterSpacing","fontSize","fontFamily","fontWeight","textTransform"]);var d=c.width();return c.remove(),d},L=function(a){var b=null,c=function(c,d){var e,f,g,h,i,j,k,l;c=c||window.event||{},d=d||{},c.metaKey||c.altKey||(d.force||a.data("grow")!==!1)&&(e=a.val(),c.type&&"keydown"===c.type.toLowerCase()&&(f=c.keyCode,g=f>=97&&122>=f||f>=65&&90>=f||f>=48&&57>=f||32===f,f===r||f===q?(l=I(a[0]),l.length?e=e.substring(0,l.start)+e.substring(l.start+l.length):f===q&&l.start?e=e.substring(0,l.start-1)+e.substring(l.start+1):f===r&&"undefined"!=typeof l.start&&(e=e.substring(0,l.start)+e.substring(l.start+1))):g&&(j=c.shiftKey,k=String.fromCharCode(c.keyCode),k=j?k.toUpperCase():k.toLowerCase(),e+=k)),h=a.attr("placeholder"),!e&&h&&(e=h),i=K(e,a)+4,i!==b&&(b=i,a.width(i),a.triggerHandler("resize")))};a.on("keydown keyup update blur",c),c()},M=function(a,b){var d,e,f,g,h=this;g=a[0],g.selectize=h;var i=window.getComputedStyle&&window.getComputedStyle(g,null);if(f=i?i.getPropertyValue("direction"):g.currentStyle&&g.currentStyle.direction,f=f||a.parents("[dir]:first").attr("dir")||"",$.extend(h,{order:0,settings:b,$input:a,tabIndex:a.attr("tabindex")||"",tagType:"select"===g.tagName.toLowerCase()?w:x,rtl:/rtl/i.test(f),eventNS:".selectize"+ ++M.count,highlightedValue:null,isOpen:!1,isDisabled:!1,isRequired:a.is("[required]"),isInvalid:!1,isLocked:!1,isFocused:!1,isInputHidden:!1,isSetup:!1,isShiftDown:!1,isCmdDown:!1,isCtrlDown:!1,ignoreFocus:!1,ignoreBlur:!1,ignoreHover:!1,hasOptions:!1,currentResults:null,lastValue:"",caretPos:0,loading:0,loadedSearches:{},$activeOption:null,$activeItems:[],optgroups:{},options:{},userOptions:{},items:[],renderCache:{},onSearchChange:null===b.loadThrottle?h.onSearchChange:F(h.onSearchChange,b.loadThrottle)}),h.sifter=new c(this.options,{diacritics:b.diacritics}),h.settings.options){for(d=0,e=h.settings.options.length;e>d;d++)h.registerOption(h.settings.options[d]);delete h.settings.options}if(h.settings.optgroups){for(d=0,e=h.settings.optgroups.length;e>d;d++)h.registerOptionGroup(h.settings.optgroups[d]);delete h.settings.optgroups}h.settings.mode=h.settings.mode||(1===h.settings.maxItems?"single":"multi"),"boolean"!=typeof h.settings.hideSelected&&(h.settings.hideSelected="multi"===h.settings.mode),h.initializePlugins(h.settings.plugins),h.setupCallbacks(),h.setupTemplates(),h.setup()};return f.mixin(M),d.mixin(M),$.extend(M.prototype,{setup:function(){var a,b,c,d,e,f,h,i,j,k=this,l=k.settings,m=k.eventNS,n=$(window),o=$(document),p=k.$input;if(h=k.settings.mode,i=p.attr("class")||"",a=$("<div>").addClass(l.wrapperClass).addClass(i).addClass(h),b=$("<div>").addClass(l.inputClass).addClass("items").appendTo(a),c=$('<input type="text" autocomplete="off" />').appendTo(b).attr("tabindex",p.is(":disabled")?"-1":k.tabIndex),f=$(l.dropdownParent||a),d=$("<div>").addClass(l.dropdownClass).addClass(h).hide().appendTo(f),e=$("<div>").addClass(l.dropdownContentClass).appendTo(d),k.settings.copyClassesToDropdown&&d.addClass(i),a.css({width:p[0].style.width}),k.plugins.names.length&&(j="plugin-"+k.plugins.names.join(" plugin-"),a.addClass(j),d.addClass(j)),(null===l.maxItems||l.maxItems>1)&&k.tagType===w&&p.attr("multiple","multiple"),k.settings.placeholder&&c.attr("placeholder",l.placeholder),!k.settings.splitOn&&k.settings.delimiter){var q=k.settings.delimiter.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&");k.settings.splitOn=new RegExp("\\s*"+q+"+\\s*")}p.attr("autocorrect")&&c.attr("autocorrect",p.attr("autocorrect")),p.attr("autocapitalize")&&c.attr("autocapitalize",p.attr("autocapitalize")),k.$wrapper=a,k.$control=b,k.$control_input=c,k.$dropdown=d,k.$dropdown_content=e,d.on("mouseenter","[data-selectable]",function(){return k.onOptionHover.apply(k,arguments)}),d.on("mousedown click","[data-selectable]",function(){return k.onOptionSelect.apply(k,arguments)}),H(b,"mousedown","*:not(input)",function(){return k.onItemSelect.apply(k,arguments)}),L(c),b.on({mousedown:function(){return k.onMouseDown.apply(k,arguments)},click:function(){return k.onClick.apply(k,arguments)}}),c.on({mousedown:function(a){a.stopPropagation()},keydown:function(){return k.onKeyDown.apply(k,arguments)},keyup:function(){return k.onKeyUp.apply(k,arguments)},keypress:function(){return k.onKeyPress.apply(k,arguments)},resize:function(){k.positionDropdown.apply(k,[])},blur:function(){return k.onBlur.apply(k,arguments)},focus:function(){return k.ignoreBlur=!1,k.onFocus.apply(k,arguments)},paste:function(){return k.onPaste.apply(k,arguments)}}),o.on("keydown"+m,function(a){k.isCmdDown=a[g?"metaKey":"ctrlKey"],k.isCtrlDown=a[g?"altKey":"ctrlKey"],k.isShiftDown=a.shiftKey}),o.on("keyup"+m,function(a){a.keyCode===u&&(k.isCtrlDown=!1),a.keyCode===s&&(k.isShiftDown=!1),a.keyCode===t&&(k.isCmdDown=!1)}),o.on("mousedown"+m,function(a){if(k.isFocused){if(a.target===k.$dropdown[0]||a.target.parentNode===k.$dropdown[0])return!1;k.$control.has(a.target).length||a.target===k.$control[0]||k.blur(a.target)}}),n.on(["scroll"+m,"resize"+m].join(" "),function(){k.isOpen&&k.positionDropdown.apply(k,arguments)}),n.on("mousemove"+m,function(){k.ignoreHover=!1}),this.revertSettings={$children:p.children().detach(),tabindex:p.attr("tabindex")},p.attr("tabindex",-1).hide().after(k.$wrapper),$.isArray(l.items)&&(k.setValue(l.items),delete l.items),y&&p.on("invalid"+m,function(a){a.preventDefault(),k.isInvalid=!0,k.refreshState()}),k.updateOriginalInput(),k.refreshItems(),k.refreshState(),k.updatePlaceholder(),k.isSetup=!0,p.is(":disabled")&&k.disable(),k.on("change",this.onChange),p.data("selectize",k),p.addClass("selectized"),k.trigger("initialize"),l.preload===!0&&k.onSearchChange("")},setupTemplates:function(){var a=this,b=a.settings.labelField,c=a.settings.optgroupLabelField,d={optgroup:function(a){return'<div class="optgroup">'+a.html+"</div>"},optgroup_header:function(a,b){return'<div class="optgroup-header">'+b(a[c])+"</div>"},option:function(a,c){return'<div class="option">'+c(a[b])+"</div>"},item:function(a,c){return'<div class="item">'+c(a[b])+"</div>"},option_create:function(a,b){return'<div class="create">添加 <strong>'+b(a.input)+"</strong>&hellip;</div>"}};a.settings.render=$.extend({},d,a.settings.render)},setupCallbacks:function(){var a,b,c={initialize:"onInitialize",change:"onChange",item_add:"onItemAdd",item_remove:"onItemRemove",clear:"onClear",option_add:"onOptionAdd",option_remove:"onOptionRemove",option_clear:"onOptionClear",optgroup_add:"onOptionGroupAdd",optgroup_remove:"onOptionGroupRemove",optgroup_clear:"onOptionGroupClear",dropdown_open:"onDropdownOpen",dropdown_close:"onDropdownClose",type:"onType",load:"onLoad",focus:"onFocus",blur:"onBlur"};for(a in c)c.hasOwnProperty(a)&&(b=this.settings[c[a]],b&&this.on(a,b))},onClick:function(a){var b=this;b.isFocused||(b.focus(),a.preventDefault())},onMouseDown:function(a){var b=this,c=a.isDefaultPrevented();$(a.target);if(b.isFocused){if(a.target!==b.$control_input[0])return"single"===b.settings.mode?b.isOpen?b.close():b.open():c||b.setActiveItem(null),!1}else c||window.setTimeout(function(){b.focus()},0)},onChange:function(){this.$input.trigger("change")},onPaste:function(a){var b=this;b.isFull()||b.isInputHidden||b.isLocked?a.preventDefault():b.settings.splitOn&&setTimeout(function(){for(var a=$.trim(b.$control_input.val()||"").split(b.settings.splitOn),c=0,d=a.length;d>c;c++)b.createItem(a[c])},0)},onKeyPress:function(a){if(this.isLocked)return a&&a.preventDefault();var b=String.fromCharCode(a.keyCode||a.which);return this.settings.create&&"multi"===this.settings.mode&&b===this.settings.delimiter?(this.createItem(),a.preventDefault(),!1):void 0},onKeyDown:function(a){var b=(a.target===this.$control_input[0],this);if(b.isLocked)return void(a.keyCode!==v&&a.preventDefault());switch(a.keyCode){case h:if(b.isCmdDown)return void b.selectAll();break;case j:return void(b.isOpen&&(a.preventDefault(),a.stopPropagation(),b.close()));case p:if(!a.ctrlKey||a.altKey)break;case o:if(!b.isOpen&&b.hasOptions)b.open();else if(b.$activeOption){b.ignoreHover=!0;var c=b.getAdjacentOption(b.$activeOption,1);c.length&&b.setActiveOption(c,!0,!0)}return void a.preventDefault();case m:if(!a.ctrlKey||a.altKey)break;case l:if(b.$activeOption){b.ignoreHover=!0;var d=b.getAdjacentOption(b.$activeOption,-1);d.length&&b.setActiveOption(d,!0,!0)}return void a.preventDefault();case i:return void(b.isOpen&&b.$activeOption&&(b.onOptionSelect({currentTarget:b.$activeOption}),a.preventDefault()));case k:return void b.advanceSelection(-1,a);case n:return void b.advanceSelection(1,a);case v:return b.settings.selectOnTab&&b.isOpen&&b.$activeOption&&(b.onOptionSelect({currentTarget:b.$activeOption}),b.isFull()||a.preventDefault()),void(b.settings.create&&b.createItem()&&a.preventDefault());case q:case r:return void b.deleteSelection(a)}return!b.isFull()&&!b.isInputHidden||(g?a.metaKey:a.ctrlKey)?void 0:void a.preventDefault()},onKeyUp:function(a){var b=this;if(b.isLocked)return a&&a.preventDefault();var c=b.$control_input.val()||"";b.lastValue!==c&&(b.lastValue=c,b.onSearchChange(c),b.refreshOptions(),b.trigger("type",c))},onSearchChange:function(a){var b=this,c=b.settings.load;c&&(b.loadedSearches.hasOwnProperty(a)||(b.loadedSearches[a]=!0,b.load(function(d){c.apply(b,[a,d])})))},onFocus:function(a){var b=this,c=b.isFocused;return b.isDisabled?(b.blur(),a&&a.preventDefault(),!1):void(b.ignoreFocus||(b.isFocused=!0,"focus"===b.settings.preload&&b.onSearchChange(""),c||b.trigger("focus"),b.$activeItems.length||(b.showInput(),b.setActiveItem(null),b.refreshOptions(!!b.settings.openOnFocus)),b.refreshState()))},onBlur:function(a,b){var c=this;if(c.isFocused&&(c.isFocused=!1,!c.ignoreFocus)){if(!c.ignoreBlur&&document.activeElement===c.$dropdown_content[0])return c.ignoreBlur=!0,void c.onFocus(a);var d=function(){c.close(),c.setTextboxValue(""),c.setActiveItem(null),c.setActiveOption(null),c.setCaret(c.items.length),c.refreshState(),(b||document.body).focus(),c.ignoreFocus=!1,c.trigger("blur")};c.ignoreFocus=!0,c.settings.create&&c.settings.createOnBlur?c.createItem(null,!1,d):d()}},onOptionHover:function(a){this.ignoreHover||this.setActiveOption(a.currentTarget,!1)},onOptionSelect:function(a){var b,c,d=this;a.preventDefault&&(a.preventDefault(),a.stopPropagation()),c=$(a.currentTarget),c.hasClass("create")?d.createItem(null,function(){d.settings.closeAfterSelect&&d.close()}):(b=c.attr("data-value"),"undefined"!=typeof b&&(d.lastQuery=null,d.setTextboxValue(""),d.addItem(b),d.settings.closeAfterSelect?d.close():!d.settings.hideSelected&&a.type&&/mouse/.test(a.type)&&d.setActiveOption(d.getOption(b))))},onItemSelect:function(a){var b=this;b.isLocked||"multi"===b.settings.mode&&(a.preventDefault(),b.setActiveItem(a.currentTarget,a))},load:function(a){var b=this,c=b.$wrapper.addClass(b.settings.loadingClass);b.loading++,a.apply(b,[function(a){b.loading=Math.max(b.loading-1,0),a&&a.length&&(b.addOption(a),b.refreshOptions(b.isFocused&&!b.isInputHidden)),b.loading||c.removeClass(b.settings.loadingClass),b.trigger("load",a)}])},setTextboxValue:function(a){var b=this.$control_input,c=b.val()!==a;c&&(b.val(a).triggerHandler("update"),this.lastValue=a)},getValue:function(){return this.tagType===w&&this.$input.attr("multiple")?this.items:this.items.join(this.settings.delimiter)},setValue:function(a,b){var c=b?[]:["change"];G(this,c,function(){this.clear(b),this.addItems(a,b)})},setActiveItem:function(a,b){var c,d,e,f,g,h,i,j,k=this;if("single"!==k.settings.mode){if(a=$(a),!a.length)return $(k.$activeItems).removeClass("active"),k.$activeItems=[],void(k.isFocused&&k.showInput());if(c=b&&b.type.toLowerCase(),"mousedown"===c&&k.isShiftDown&&k.$activeItems.length){for(j=k.$control.children(".active:last"),f=Array.prototype.indexOf.apply(k.$control[0].childNodes,[j[0]]),g=Array.prototype.indexOf.apply(k.$control[0].childNodes,[a[0]]),f>g&&(i=f,f=g,g=i),d=f;g>=d;d++)h=k.$control[0].childNodes[d],-1===k.$activeItems.indexOf(h)&&($(h).addClass("active"),k.$activeItems.push(h));b.preventDefault()}else"mousedown"===c&&k.isCtrlDown||"keydown"===c&&this.isShiftDown?a.hasClass("active")?(e=k.$activeItems.indexOf(a[0]),k.$activeItems.splice(e,1),a.removeClass("active")):k.$activeItems.push(a.addClass("active")[0]):($(k.$activeItems).removeClass("active"),k.$activeItems=[a.addClass("active")[0]]);k.hideInput(),this.isFocused||k.focus()}},setActiveOption:function(a,b,c){var d,e,f,g,h,i=this;i.$activeOption&&i.$activeOption.removeClass("active"),i.$activeOption=null,a=$(a),a.length&&(i.$activeOption=a.addClass("active"),(b||!z(b))&&(d=i.$dropdown_content.height(),e=i.$activeOption.outerHeight(!0),b=i.$dropdown_content.scrollTop()||0,f=i.$activeOption.offset().top-i.$dropdown_content.offset().top+b,g=f,h=f-d+e,f+e>d+b?i.$dropdown_content.stop().animate({scrollTop:h},c?i.settings.scrollDuration:0):b>f&&i.$dropdown_content.stop().animate({scrollTop:g},c?i.settings.scrollDuration:0)))},selectAll:function(){var a=this;"single"!==a.settings.mode&&(a.$activeItems=Array.prototype.slice.apply(a.$control.children(":not(input)").addClass("active")),a.$activeItems.length&&(a.hideInput(),a.close()),a.focus())},hideInput:function(){var a=this;a.setTextboxValue(""),a.$control_input.css({opacity:0,position:"absolute",left:a.rtl?1e4:-1e4}),a.isInputHidden=!0},showInput:function(){this.$control_input.css({opacity:1,position:"relative",left:0}),this.isInputHidden=!1},focus:function(){var a=this;a.isDisabled||(a.ignoreFocus=!0,a.$control_input[0].focus(),window.setTimeout(function(){a.ignoreFocus=!1,a.onFocus()},0))},blur:function(a){this.$control_input[0].blur(),this.onBlur(null,a)},getScoreFunction:function(a){return this.sifter.getScoreFunction(a,this.getSearchOptions())},getSearchOptions:function(){var a=this.settings,b=a.sortField;return"string"==typeof b&&(b=[{field:b}]),{fields:a.searchField,conjunction:a.searchConjunction,sort:b}},search:function(a){var b,c,d,e=this,f=e.settings,g=this.getSearchOptions();if(f.score&&(d=e.settings.score.apply(this,[a]),"function"!=typeof d))throw new Error('Selectize "score" setting must be a function that returns a function');if(a!==e.lastQuery?(e.lastQuery=a,c=e.sifter.search(a,$.extend(g,{score:d})),e.currentResults=c):c=$.extend(!0,{},e.currentResults),f.hideSelected)for(b=c.items.length-1;b>=0;b--)-1!==e.items.indexOf(A(c.items[b].id))&&c.items.splice(b,1);return c},refreshOptions:function(a){var b,c,d,f,g,h,i,j,k,l,m,n,o,p,q,r;"undefined"==typeof a&&(a=!0);var s=this,t=$.trim(s.$control_input.val()),u=s.search(t),v=s.$dropdown_content,w=s.$activeOption&&A(s.$activeOption.attr("data-value"));for(f=u.items.length,"number"==typeof s.settings.maxOptions&&(f=Math.min(f,s.settings.maxOptions)),g={},h=[],b=0;f>b;b++)for(i=s.options[u.items[b].id],j=s.render("option",i),k=i[s.settings.optgroupField]||"",l=$.isArray(k)?k:[k],c=0,d=l&&l.length;d>c;c++)k=l[c],s.optgroups.hasOwnProperty(k)||(k=""),g.hasOwnProperty(k)||(g[k]=[],h.push(k)),g[k].push(j);for(this.settings.lockOptgroupOrder&&h.sort(function(a,b){var c=s.optgroups[a].$order||0,d=s.optgroups[b].$order||0;return c-d}),m=[],b=0,f=h.length;f>b;b++)k=h[b],s.optgroups.hasOwnProperty(k)&&g[k].length?(n=s.render("optgroup_header",s.optgroups[k])||"",n+=g[k].join(""),m.push(s.render("optgroup",$.extend({},s.optgroups[k],{html:n})))):m.push(g[k].join(""));if(v.html(m.join("")),s.settings.highlight&&u.query.length&&u.tokens.length)for(b=0,f=u.tokens.length;f>b;b++)e(v,u.tokens[b].regex);if(!s.settings.hideSelected)for(b=0,f=s.items.length;f>b;b++)s.getOption(s.items[b]).addClass("selected");o=s.canCreate(t),o&&(v.prepend(s.render("option_create",{input:t})),r=$(v[0].childNodes[0])),s.hasOptions=u.items.length>0||o,s.hasOptions?(u.items.length>0?(q=w&&s.getOption(w),q&&q.length?p=q:"single"===s.settings.mode&&s.items.length&&(p=s.getOption(s.items[0])),p&&p.length||(p=r&&!s.settings.addPrecedence?s.getAdjacentOption(r,1):v.find("[data-selectable]:first"))):p=r,s.setActiveOption(p),a&&!s.isOpen&&s.open()):(s.setActiveOption(null),a&&s.isOpen&&s.close())},addOption:function(a){var b,c,d,e=this;if($.isArray(a))for(b=0,c=a.length;c>b;b++)e.addOption(a[b]);else(d=e.registerOption(a))&&(e.userOptions[d]=!0,e.lastQuery=null,e.trigger("option_add",d,a))},registerOption:function(a){var b=A(a[this.settings.valueField]);return!b||this.options.hasOwnProperty(b)?!1:(a.$order=a.$order||++this.order,this.options[b]=a,b)},registerOptionGroup:function(a){var b=A(a[this.settings.optgroupValueField]);return b?(a.$order=a.$order||++this.order,this.optgroups[b]=a,b):!1},addOptionGroup:function(a,b){b[this.settings.optgroupValueField]=a,(a=this.registerOptionGroup(b))&&this.trigger("optgroup_add",a,b)},removeOptionGroup:function(a){this.optgroups.hasOwnProperty(a)&&(delete this.optgroups[a],this.renderCache={},this.trigger("optgroup_remove",a))},clearOptionGroups:function(){this.optgroups={},this.renderCache={},this.trigger("optgroup_clear")},updateOption:function(a,b){var c,d,e,f,g,h,i,j=this;if(a=A(a),e=A(b[j.settings.valueField]),null!==a&&j.options.hasOwnProperty(a)){if("string"!=typeof e)throw new Error("Value must be set in option data");i=j.options[a].$order,e!==a&&(delete j.options[a],f=j.items.indexOf(a),-1!==f&&j.items.splice(f,1,e)),b.$order=b.$order||i,j.options[e]=b,g=j.renderCache.item,h=j.renderCache.option,g&&(delete g[a],delete g[e]),h&&(delete h[a],delete h[e]),-1!==j.items.indexOf(e)&&(c=j.getItem(a),d=$(j.render("item",b)),c.hasClass("active")&&d.addClass("active"),c.replaceWith(d)),j.lastQuery=null,j.isOpen&&j.refreshOptions(!1)}},removeOption:function(a,b){var c=this;a=A(a);var d=c.renderCache.item,e=c.renderCache.option;d&&delete d[a],e&&delete e[a],delete c.userOptions[a],delete c.options[a],c.lastQuery=null,c.trigger("option_remove",a),c.removeItem(a,b)},clearOptions:function(){var a=this;a.loadedSearches={},a.userOptions={},a.renderCache={},a.options=a.sifter.items={},a.lastQuery=null,a.trigger("option_clear"),a.clear()},getOption:function(a){return this.getElementWithValue(a,this.$dropdown_content.find("[data-selectable]"))},getAdjacentOption:function(a,b){var c=this.$dropdown.find("[data-selectable]"),d=c.index(a)+b;return d>=0&&d<c.length?c.eq(d):$()},getElementWithValue:function(a,b){if(a=A(a),"undefined"!=typeof a&&null!==a)for(var c=0,d=b.length;d>c;c++)if(b[c].getAttribute("data-value")===a)return $(b[c]);return $()},getItem:function(a){return this.getElementWithValue(a,this.$control.children())},addItems:function(a,b){for(var c=$.isArray(a)?a:[a],d=0,e=c.length;e>d;d++)this.isPending=e-1>d,this.addItem(c[d],b)},addItem:function(a,b){var c=b?[]:["change"];G(this,c,function(){var c,d,e,f,g,h=this,i=h.settings.mode;return a=A(a),-1!==h.items.indexOf(a)?void("single"===i&&h.close()):void(h.options.hasOwnProperty(a)&&("single"===i&&h.clear(b),"multi"===i&&h.isFull()||(c=$(h.render("item",h.options[a])),g=h.isFull(),h.items.splice(h.caretPos,0,a),h.insertAtCaret(c),(!h.isPending||!g&&h.isFull())&&h.refreshState(),h.isSetup&&(e=h.$dropdown_content.find("[data-selectable]"),h.isPending||(d=h.getOption(a),f=h.getAdjacentOption(d,1).attr("data-value"),h.refreshOptions(h.isFocused&&"single"!==i),f&&h.setActiveOption(h.getOption(f))),!e.length||h.isFull()?h.close():h.positionDropdown(),h.updatePlaceholder(),h.trigger("item_add",a,c),h.updateOriginalInput({silent:b})))))})},removeItem:function(a,b){var c,d,e,f=this;c="object"==typeof a?a:f.getItem(a),a=A(c.attr("data-value")),d=f.items.indexOf(a),-1!==d&&(c.remove(),c.hasClass("active")&&(e=f.$activeItems.indexOf(c[0]),f.$activeItems.splice(e,1)),f.items.splice(d,1),f.lastQuery=null,!f.settings.persist&&f.userOptions.hasOwnProperty(a)&&f.removeOption(a,b),d<f.caretPos&&f.setCaret(f.caretPos-1),f.refreshState(),f.updatePlaceholder(),f.updateOriginalInput({silent:b}),f.positionDropdown(),f.trigger("item_remove",a,c))},createItem:function(a,b){var c=this,d=c.caretPos;a=a||$.trim(c.$control_input.val()||"");var e=arguments[arguments.length-1];if("function"!=typeof e&&(e=function(){}),"boolean"!=typeof b&&(b=!0),!c.canCreate(a))return e(),!1;c.lock();var f="function"==typeof c.settings.create?this.settings.create:function(a){var b={};return b[c.settings.labelField]=a,b[c.settings.valueField]=a,b},g=E(function(a){if(c.unlock(),!a||"object"!=typeof a)return e();var f=A(a[c.settings.valueField]);return"string"!=typeof f?e():(c.setTextboxValue(""),c.addOption(a),c.setCaret(d),c.addItem(f),c.refreshOptions(b&&"single"!==c.settings.mode),void e(a))}),h=f.apply(this,[a,g]);return"undefined"!=typeof h&&g(h),!0},refreshItems:function(){this.lastQuery=null,this.isSetup&&this.addItem(this.items),this.refreshState(),this.updateOriginalInput()},refreshState:function(){var a,b=this;b.isRequired&&(b.items.length&&(b.isInvalid=!1),b.$control_input.prop("required",a)),b.refreshClasses()},refreshClasses:function(){var a=this,b=a.isFull(),c=a.isLocked;a.$wrapper.toggleClass("rtl",a.rtl),a.$control.toggleClass("focus",a.isFocused).toggleClass("disabled",a.isDisabled).toggleClass("required",a.isRequired).toggleClass("invalid",a.isInvalid).toggleClass("locked",c).toggleClass("full",b).toggleClass("not-full",!b).toggleClass("input-active",a.isFocused&&!a.isInputHidden).toggleClass("dropdown-active",a.isOpen).toggleClass("has-options",!$.isEmptyObject(a.options)).toggleClass("has-items",a.items.length>0),a.$control_input.data("grow",!b&&!c)},isFull:function(){return null!==this.settings.maxItems&&this.items.length>=this.settings.maxItems},updateOriginalInput:function(a){var b,c,d,e,f=this;if(a=a||{},f.tagType===w){for(d=[],b=0,c=f.items.length;c>b;b++)e=f.options[f.items[b]][f.settings.labelField]||"",d.push('<option value="'+B(f.items[b])+'" selected="selected">'+B(e)+"</option>");d.length||this.$input.attr("multiple")||d.push('<option value="" selected="selected"></option>'),f.$input.html(d.join(""))}else f.$input.val(f.getValue()),f.$input.attr("value",f.$input.val());f.isSetup&&(a.silent||f.trigger("change",f.$input.val()))},updatePlaceholder:function(){if(this.settings.placeholder){var a=this.$control_input;this.items.length?a.removeAttr("placeholder"):a.attr("placeholder",this.settings.placeholder),a.triggerHandler("update",{force:!0})}},open:function(){var a=this;a.isLocked||a.isOpen||"multi"===a.settings.mode&&a.isFull()||(a.focus(),a.isOpen=!0,a.refreshState(),a.$dropdown.css({visibility:"hidden",display:"block"}),a.positionDropdown(),a.$dropdown.css({visibility:"visible"}),a.trigger("dropdown_open",a.$dropdown))},close:function(){var a=this,b=a.isOpen;"single"===a.settings.mode&&a.items.length&&a.hideInput(),a.isOpen=!1,a.$dropdown.hide(),a.setActiveOption(null),a.refreshState(),b&&a.trigger("dropdown_close",a.$dropdown)},positionDropdown:function(){var a=this.$control,b="body"===this.settings.dropdownParent?a.offset():a.position();b.top+=a.outerHeight(!0),this.$dropdown.css({width:a.outerWidth(),top:b.top,left:b.left})},clear:function(a){var b=this;b.items.length&&(b.$control.children(":not(input)").remove(),b.items=[],b.lastQuery=null,b.setCaret(0),b.setActiveItem(null),b.updatePlaceholder(),b.updateOriginalInput({silent:a}),b.refreshState(),b.showInput(),b.trigger("clear"))},insertAtCaret:function(a){var b=Math.min(this.caretPos,this.items.length);0===b?this.$control.prepend(a):$(this.$control[0].childNodes[b]).before(a),this.setCaret(b+1)},deleteSelection:function(a){var b,c,d,e,f,g,h,i,j,k=this;if(d=a&&a.keyCode===q?-1:1,e=I(k.$control_input[0]),k.$activeOption&&!k.settings.hideSelected&&(h=k.getAdjacentOption(k.$activeOption,-1).attr("data-value")),f=[],k.$activeItems.length){for(j=k.$control.children(".active:"+(d>0?"last":"first")),g=k.$control.children(":not(input)").index(j),d>0&&g++,b=0,c=k.$activeItems.length;c>b;b++)f.push($(k.$activeItems[b]).attr("data-value"));a&&(a.preventDefault(),a.stopPropagation())}else(k.isFocused||"single"===k.settings.mode)&&k.items.length&&(0>d&&0===e.start&&0===e.length?f.push(k.items[k.caretPos-1]):d>0&&e.start===k.$control_input.val().length&&f.push(k.items[k.caretPos]));if(!f.length||"function"==typeof k.settings.onDelete&&k.settings.onDelete.apply(k,[f])===!1)return!1;for("undefined"!=typeof g&&k.setCaret(g);f.length;)k.removeItem(f.pop());return k.showInput(),k.positionDropdown(),k.refreshOptions(!0),h&&(i=k.getOption(h),i.length&&k.setActiveOption(i)),!0},advanceSelection:function(a,b){var c,d,e,f,g,h,i=this;0!==a&&(i.rtl&&(a*=-1),c=a>0?"last":"first",d=I(i.$control_input[0]),i.isFocused&&!i.isInputHidden?(f=i.$control_input.val().length,g=0>a?0===d.start&&0===d.length:d.start===f,g&&!f&&i.advanceCaret(a,b)):(h=i.$control.children(".active:"+c),h.length&&(e=i.$control.children(":not(input)").index(h),i.setActiveItem(null),i.setCaret(a>0?e+1:e))))},advanceCaret:function(a,b){var c,d,e=this;0!==a&&(c=a>0?"next":"prev",e.isShiftDown?(d=e.$control_input[c](),d.length&&(e.hideInput(),e.setActiveItem(d),b&&b.preventDefault())):e.setCaret(e.caretPos+a))},setCaret:function(a){var b=this;if(a="single"===b.settings.mode?b.items.length:Math.max(0,Math.min(b.items.length,a)),!b.isPending){var c,d,e,f;for(e=b.$control.children(":not(input)"),c=0,d=e.length;d>c;c++)f=$(e[c]).detach(),a>c?b.$control_input.before(f):b.$control.append(f)}b.caretPos=a},lock:function(){this.close(),this.isLocked=!0,this.refreshState()},unlock:function(){this.isLocked=!1,this.refreshState()},disable:function(){var a=this;a.$input.prop("disabled",!0),a.$control_input.prop("disabled",!0).prop("tabindex",-1),a.isDisabled=!0,a.lock()},enable:function(){var a=this;a.$input.prop("disabled",!1),a.$control_input.prop("disabled",!1).prop("tabindex",a.tabIndex),a.isDisabled=!1,a.unlock()},destroy:function(){var a=this,b=a.eventNS,c=a.revertSettings;a.trigger("destroy"),a.off(),a.$wrapper.remove(),a.$dropdown.remove(),a.$input.html("").append(c.$children).removeAttr("tabindex").removeClass("selectized").attr({tabindex:c.tabindex}).show(),a.$control_input.removeData("grow"),a.$input.removeData("selectize"),$(window).off(b),$(document).off(b),$(document.body).off(b),delete a.$input[0].selectize},render:function(a,b){var c,d,e="",f=!1,g=this,h=/^[\t \r\n]*<([a-z][a-z0-9\-_]*(?:\:[a-z][a-z0-9\-_]*)?)/i;return("option"===a||"item"===a)&&(c=A(b[g.settings.valueField]),f=!!c),f&&(z(g.renderCache[a])||(g.renderCache[a]={}),g.renderCache[a].hasOwnProperty(c))?g.renderCache[a][c]:(e=g.settings.render[a].apply(this,[b,B]),("option"===a||"option_create"===a)&&(e=e.replace(h,"<$1 data-selectable")),"optgroup"===a&&(d=b[g.settings.optgroupValueField]||"",e=e.replace(h,'<$1 data-group="'+C(B(d))+'"')),("option"===a||"item"===a)&&(e=e.replace(h,'<$1 data-value="'+C(B(c||""))+'"')),f&&(g.renderCache[a][c]=e),e)},clearCache:function(a){var b=this;"undefined"==typeof a?b.renderCache={}:delete b.renderCache[a]},canCreate:function(a){var b=this;if(!b.settings.create)return!1;var c=b.settings.createFilter;return!(!a.length||"function"==typeof c&&!c.apply(b,[a])||"string"==typeof c&&!new RegExp(c).test(a)||c instanceof RegExp&&!c.test(a))}}),M.count=0,M.defaults={options:[],optgroups:[],plugins:[],delimiter:",",splitOn:null,persist:!0,diacritics:!0,create:!1,createOnBlur:!1,createFilter:null,highlight:!0,openOnFocus:!0,maxOptions:1e3,maxItems:null,hideSelected:null,addPrecedence:!1,selectOnTab:!1,preload:!1,allowEmptyOption:!1,closeAfterSelect:!1,scrollDuration:60,loadThrottle:300,loadingClass:"loading",dataAttr:"data-data",optgroupField:"optgroup",valueField:"value",labelField:"text",optgroupLabelField:"label",optgroupValueField:"value",lockOptgroupOrder:!1,sortField:"$order",searchField:["text"],searchConjunction:"and",mode:null,wrapperClass:"selectize-control",inputClass:"selectize-input",dropdownClass:"selectize-dropdown",dropdownContentClass:"selectize-dropdown-content",dropdownParent:null,copyClassesToDropdown:!0,render:{}},$.fn.selectize=function(a){var b=$.fn.selectize.defaults,c=$.extend({},b,a),d=c.dataAttr,e=c.labelField,f=c.valueField,g=c.optgroupField,h=c.optgroupLabelField,i=c.optgroupValueField,j=function(a,b){var g,h,i,j,k=a.attr(d);if(k)for(b.options=JSON.parse(k),g=0,h=b.options.length;h>g;g++)b.items.push(b.options[g][f]);else{var l=$.trim(a.val()||"");if(!c.allowEmptyOption&&!l.length)return;for(i=l.split(c.delimiter),g=0,h=i.length;h>g;g++)j={},j[e]=i[g],j[f]=i[g],b.options.push(j);b.items=i}},k=function(a,b){var j,k,l,m,n=b.options,o={},p=function(a){var b=d&&a.attr(d);return"string"==typeof b&&b.length?JSON.parse(b):null},q=function(a,d){a=$(a);var h=A(a.attr("value"));if(h||c.allowEmptyOption)if(o.hasOwnProperty(h)){if(d){var i=o[h][g];i?$.isArray(i)?i.push(d):o[h][g]=[i,d]:o[h][g]=d}}else{var j=p(a)||{};j[e]=j[e]||a.text(),j[f]=j[f]||h,j[g]=j[g]||d,o[h]=j,n.push(j),a.is(":selected")&&b.items.push(h)}},r=function(a){var c,d,e,f,g;for(a=$(a),e=a.attr("label"),e&&(f=p(a)||{},f[h]=e,f[i]=e,b.optgroups.push(f)),g=$("option",a),
c=0,d=g.length;d>c;c++)q(g[c],e)};for(b.maxItems=a.attr("multiple")?null:1,m=a.children(),j=0,k=m.length;k>j;j++)l=m[j].tagName.toLowerCase(),"optgroup"===l?r(m[j]):"option"===l&&q(m[j])};return this.each(function(){if(!this.selectize){var d,e=$(this),f=this.tagName.toLowerCase(),g=e.attr("placeholder")||e.attr("data-placeholder");g||c.allowEmptyOption||(g=e.children('option[value=""]').text());var h={placeholder:g,options:[],optgroups:[],items:[]};"select"===f?k(e,h):j(e,h),d=new M(e,$.extend(!0,{},b,h,a))}})},$.fn.selectize.defaults=M.defaults,$.fn.selectize.support={validity:y},M.define("drag_drop",function(a){if(!$.fn.sortable)throw new Error('The "drag_drop" plugin requires jQuery UI "sortable".');if("multi"===this.settings.mode){var b=this;b.lock=function(){var a=b.lock;return function(){var c=b.$control.data("sortable");return c&&c.disable(),a.apply(b,arguments)}}(),b.unlock=function(){var a=b.unlock;return function(){var c=b.$control.data("sortable");return c&&c.enable(),a.apply(b,arguments)}}(),b.setup=function(){var a=b.setup;return function(){a.apply(this,arguments);var c=b.$control.sortable({items:"[data-value]",forcePlaceholderSize:!0,disabled:b.isLocked,start:function(a,b){b.placeholder.css("width",b.helper.css("width")),c.css({overflow:"visible"})},stop:function(){c.css({overflow:"hidden"});var a=b.$activeItems?b.$activeItems.slice():null,d=[];c.children("[data-value]").each(function(){d.push($(this).attr("data-value"))}),b.setValue(d),b.setActiveItem(a)}})}}()}}),M.define("dropdown_header",function(a){var b=this;a=$.extend({title:"Untitled",headerClass:"selectize-dropdown-header",titleRowClass:"selectize-dropdown-header-title",labelClass:"selectize-dropdown-header-label",closeClass:"selectize-dropdown-header-close",html:function(a){return'<div class="'+a.headerClass+'"><div class="'+a.titleRowClass+'"><span class="'+a.labelClass+'">'+a.title+'</span><a href="javascript:void(0)" class="'+a.closeClass+'">&times;</a></div></div>'}},a),b.setup=function(){var c=b.setup;return function(){c.apply(b,arguments),b.$dropdown_header=$(a.html(a)),b.$dropdown.prepend(b.$dropdown_header)}}()}),M.define("optgroup_columns",function(a){var b=this;a=$.extend({equalizeWidth:!0,equalizeHeight:!0},a),this.getAdjacentOption=function(a,b){var c=a.closest("[data-group]").find("[data-selectable]"),d=c.index(a)+b;return d>=0&&d<c.length?c.eq(d):$()},this.onKeyDown=function(){var a=b.onKeyDown;return function(c){var d,e,f,g;return!this.isOpen||c.keyCode!==k&&c.keyCode!==n?a.apply(this,arguments):(b.ignoreHover=!0,g=this.$activeOption.closest("[data-group]"),d=g.find("[data-selectable]").index(this.$activeOption),g=c.keyCode===k?g.prev("[data-group]"):g.next("[data-group]"),f=g.find("[data-selectable]"),e=f.eq(Math.min(f.length-1,d)),void(e.length&&this.setActiveOption(e)))}}();var c=function(){var a,b=c.width,d=document;return"undefined"==typeof b&&(a=d.createElement("div"),a.innerHTML='<div style="width:50px;height:50px;position:absolute;left:-50px;top:-50px;overflow:auto;"><div style="width:1px;height:100px;"></div></div>',a=a.firstChild,d.body.appendChild(a),b=c.width=a.offsetWidth-a.clientWidth,d.body.removeChild(a)),b},d=function(){var d,e,f,g,h,i,j;if(j=$("[data-group]",b.$dropdown_content),e=j.length,e&&b.$dropdown_content.width()){if(a.equalizeHeight){for(f=0,d=0;e>d;d++)f=Math.max(f,j.eq(d).height());j.css({height:f})}a.equalizeWidth&&(i=b.$dropdown_content.innerWidth()-c(),g=Math.round(i/e),j.css({width:g}),e>1&&(h=i-g*(e-1),j.eq(e-1).css({width:h})))}};(a.equalizeHeight||a.equalizeWidth)&&(D.after(this,"positionDropdown",d),D.after(this,"refreshOptions",d))}),M.define("remove_button",function(a){if("single"!==this.settings.mode){a=$.extend({label:"&times;",title:"Remove",className:"remove",append:!0},a);var b=this,c='<a href="javascript:void(0)" class="'+a.className+'" tabindex="-1" title="'+B(a.title)+'">'+a.label+"</a>",d=function(a,b){var c=a.search(/(<\/[^>]+>\s*)$/);return a.substring(0,c)+b+a.substring(c)};this.setup=function(){var e=b.setup;return function(){if(a.append){var f=b.settings.render.item;b.settings.render.item=function(a){return d(f.apply(this,arguments),c)}}e.apply(this,arguments),this.$control.on("click","."+a.className,function(a){if(a.preventDefault(),!b.isLocked){var c=$(a.currentTarget).parent();b.setActiveItem(c),b.deleteSelection()&&b.setCaret(b.items.length)}})}}()}}),M.define("restore_on_backspace",function(a){var b=this;a.text=a.text||function(a){return a[this.settings.labelField]},this.onKeyDown=function(){var c=b.onKeyDown;return function(b){var d,e;return b.keyCode===q&&""===this.$control_input.val()&&!this.$activeItems.length&&(d=this.caretPos-1,d>=0&&d<this.items.length)?(e=this.options[this.items[d]],this.deleteSelection(b)&&(this.setTextboxValue(a.text.apply(this,[e])),this.refreshOptions(!0)),void b.preventDefault()):c.apply(this,arguments)}}()}),M}),define("selectize/Sifter",[],function(a,b){var c=function(a,b){this.items=a,this.settings=b||{diacritics:!0}};c.prototype.tokenize=function(a){if(a=f(String(a||"").toLowerCase()),!a||!a.length)return[];var b,c,d,e,h=[],j=a.split(/ +/);for(b=0,c=j.length;c>b;b++){if(d=g(j[b]),this.settings.diacritics)for(e in i)i.hasOwnProperty(e)&&(d=d.replace(new RegExp(e,"g"),i[e]));h.push({string:j[b],regex:new RegExp(d,"i")})}return h},c.prototype.iterator=function(a,b){var c;c=h(a)?Array.prototype.forEach||function(a){for(var b=0,c=this.length;c>b;b++)a(this[b],b,this)}:function(a){for(var b in this)this.hasOwnProperty(b)&&a(this[b],b,this)},c.apply(a,[b])},c.prototype.getScoreFunction=function(a,b){var c,d,e,f;c=this,a=c.prepareSearch(a,b),e=a.tokens,d=a.options.fields,f=e.length;var g=function(a,b){var c,d;return a?(a=String(a||""),d=a.search(b.regex),-1===d?0:(c=b.string.length/a.length,0===d&&(c+=.5),c)):0},h=function(){var a=d.length;return a?1===a?function(a,b){return g(b[d[0]],a)}:function(b,c){for(var e=0,f=0;a>e;e++)f+=g(c[d[e]],b);return f/a}:function(){return 0}}();return f?1===f?function(a){return h(e[0],a)}:"and"===a.options.conjunction?function(a){for(var b,c=0,d=0;f>c;c++){if(b=h(e[c],a),0>=b)return 0;d+=b}return d/f}:function(a){for(var b=0,c=0;f>b;b++)c+=h(e[b],a);return c/f}:function(){return 0}},c.prototype.getSortFunction=function(a,b){var c,e,f,g,h,i,j,k,l,m,n;if(f=this,a=f.prepareSearch(a,b),n=!a.query&&b.sort_empty||b.sort,l=function(a,b){return"$score"===a?b.score:f.items[b.id][a]},h=[],n)for(c=0,e=n.length;e>c;c++)(a.query||"$score"!==n[c].field)&&h.push(n[c]);if(a.query){for(m=!0,c=0,e=h.length;e>c;c++)if("$score"===h[c].field){m=!1;break}m&&h.unshift({field:"$score",direction:"desc"})}else for(c=0,e=h.length;e>c;c++)if("$score"===h[c].field){h.splice(c,1);break}for(k=[],c=0,e=h.length;e>c;c++)k.push("desc"===h[c].direction?-1:1);return i=h.length,i?1===i?(g=h[0].field,j=k[0],function(a,b){return j*d(l(g,a),l(g,b))}):function(a,b){var c,e,f;for(c=0;i>c;c++)if(f=h[c].field,e=k[c]*d(l(f,a),l(f,b)))return e;return 0}:null},c.prototype.prepareSearch=function(a,b){if("object"==typeof a)return a;b=e({},b);var c=b.fields,d=b.sort,f=b.sort_empty;return c&&!h(c)&&(b.fields=[c]),d&&!h(d)&&(b.sort=[d]),f&&!h(f)&&(b.sort_empty=[f]),{options:b,query:String(a||"").toLowerCase(),tokens:this.tokenize(a),total:0,items:[]}},c.prototype.search=function(a,b){var c,d,e,f,g=this;return d=this.prepareSearch(a,b),b=d.options,a=d.query,f=b.score||g.getScoreFunction(d),a.length?g.iterator(g.items,function(a,e){c=f(a),(b.filter===!1||c>0)&&d.items.push({score:c,id:e})}):g.iterator(g.items,function(a,b){d.items.push({score:1,id:b})}),e=g.getSortFunction(d,b),e&&d.items.sort(e),d.total=d.items.length,"number"==typeof b.limit&&(d.items=d.items.slice(0,b.limit)),d};var d=function(a,b){return"number"==typeof a&&"number"==typeof b?a>b?1:b>a?-1:0:(a=j(String(a||"")),b=j(String(b||"")),a>b?1:b>a?-1:0)},e=function(a,b){var c,d,e,f;for(c=1,d=arguments.length;d>c;c++)if(f=arguments[c])for(e in f)f.hasOwnProperty(e)&&(a[e]=f[e]);return a},f=function(a){return(a+"").replace(/^\s+|\s+$|/g,"")},g=function(a){return(a+"").replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1")},h=Array.isArray||$&&$.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)},i={a:"[aÀÁÂÃÄÅàáâãäåĀāąĄ]",c:"[cÇçćĆčČ]",d:"[dđĐďĎ]",e:"[eÈÉÊËèéêëěĚĒēęĘ]",i:"[iÌÍÎÏìíîïĪī]",l:"[lłŁ]",n:"[nÑñňŇńŃ]",o:"[oÒÓÔÕÕÖØòóôõöøŌō]",r:"[rřŘ]",s:"[sŠšśŚ]",t:"[tťŤ]",u:"[uÙÚÛÜùúûüůŮŪū]",y:"[yŸÿýÝ]",z:"[zŽžżŻźŹ]"},j=function(){var a,b,c,d,e="",f={};for(c in i)if(i.hasOwnProperty(c))for(d=i[c].substring(2,i[c].length-1),e+=d,a=0,b=d.length;b>a;a++)f[d.charAt(a)]=c;var g=new RegExp("["+e+"]","g");return function(a){return a.replace(g,function(a){return f[a]}).toLowerCase()}}();return c}),define("selectize/MicroPlugin",[],function(a,b){var c={};c.mixin=function(a){a.plugins={},a.prototype.initializePlugins=function(a){var b,c,e,f=this,g=[];if(f.plugins={names:[],settings:{},requested:{},loaded:{}},d.isArray(a))for(b=0,c=a.length;c>b;b++)"string"==typeof a[b]?g.push(a[b]):(f.plugins.settings[a[b].name]=a[b].options,g.push(a[b].name));else if(a)for(e in a)a.hasOwnProperty(e)&&(f.plugins.settings[e]=a[e],g.push(e));for(;g.length;)f.require(g.shift())},a.prototype.loadPlugin=function(b){var c=this,d=c.plugins,e=a.plugins[b];if(!a.plugins.hasOwnProperty(b))throw new Error('Unable to find "'+b+'" plugin');d.requested[b]=!0,d.loaded[b]=e.fn.apply(c,[c.plugins.settings[b]||{}]),d.names.push(b)},a.prototype.require=function(a){var b=this,c=b.plugins;if(!b.plugins.loaded.hasOwnProperty(a)){if(c.requested[a])throw new Error('Plugin has circular dependency ("'+a+'")');b.loadPlugin(a)}return c.loaded[a]},a.define=function(b,c){a.plugins[b]={name:b,fn:c}}};var d={isArray:Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)}};return c});